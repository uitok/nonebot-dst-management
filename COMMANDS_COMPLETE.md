# 命令参考文档

## 🎮 DST 管理命令完整列表

### 房间管理

#### 查看房间列表
```
/dst list [页码]
```
**功能**: 显示所有 DST 服务器房间
**权限**: 所有���户
**示例**:
```
/dst list
/dst list 2
```

**输出示例**:
```
🏕️ DST 房间列表
第 1/2 页 | 共 15 个房间

1. 勋棱神话
   状态：🟢 迷行中
   模式：无尽
   ID：2

2. 测试服务器
   状态：🔴 已停止
   模式：生存
   ID：3
```

---

#### 查看房间详情
```
/dst info <房间ID>
```
**功能**: 查看房间详细信息
**权限**: 所有用户
**示例**:
```
/dst info 2
```

**输出示例**:
```
🏕️ 勋棱神话

📋 基本信息
- 房间ID：2
- 状态：🟢 运行中
- 模式：无尽
- 玩家限制：6人
- 密码：已设置
- PVP：关闭
- 描述：有问题＋裙744834037

🌍 世界列表
- Master：🟢 在线 (端口 37777)
- Caves：🟢 在线 (端口 36666)

👥 在线玩家 (2人)
- 󰀍八雪� (KU_BQAUz1rk) - 白骨

🧩 ��安装模组：21个
```

---

#### 启动房间
```
/dst start <房间ID>
```
**功能**: 启动指定的 DST 服务器
**权限**: 管理员
**示例**:
```
/dst start 2
```

**说明**: 启动房间内的所有世界（Master + Caves）

---

#### 关闭房间
```
/dst stop <房间ID>
```
**功能**: 关闭指定的 DST 服务器
**权限**: 管理员
**示例**:
```
/dst stop 2
```

**说明**: 优雅关闭所有世界，保存游戏状态

---

#### 重启房间
```
/dst restart <房间ID>
```
**功能**: 重启指定的 DST 服务器
**权限**: �amber
**示例**:
```
/dst restart 2
```

**说明**: 重启房间内的所有世界

---

### 玩家管理

#### 查看在线玩家
```
/dst players <房间ID>
```
**功能**: 查看当前在线玩家列表
**权限**: 所有用户
**示例**:
```
/dst players 2
```

**输出示例**:
```
👥 在线玩家 (勋棱神话)

1. 󰀍八雪� (KU_BQAUz1rk)
   - KU_ID: KU_BQAUz1rk
   - 角色: 白骨
```

---

#### 踢出玩家
```
/dst kick <房间ID> <KU_ID>
```
**功能**: 踢出指定玩家
**权限**: 管理员
**示例**:
```
/dst kick 2 KU_BQAUz1rk
```

**说明**: 将玩家从所有世界中踢出

---

### 备份管理

#### 查看备份列表
```
/dst backup list <房间ID>
```
**功能**: 查看房间备份列表
**权限**: 所有用户
**示例**:
```
/dst backup list 2
```

**输出示例**:
```
💾 备份列表 (勋棱神话)

1. backup_2026-02-03_11-30-00.zip
   - 大小：245.30 MB
   - 时间：2026-02-03 11:30:00

2. backup_2026-02-02_23-00-00.zip
   - 大小：241.15 MB
   - 时间：2026-02-02 23:00:00

💡 使用 /dst backup restore <房间ID> <序号> 恢复备份
```

---

#### 创建备份
```
/dst backup create <房间ID>
```
**功能**: 创建房间快照备份
**权限**: 管�员
**示例**:
```
/dst backup create 2
```

**说明**: 会停止服务器，创建备份，然后自动重启

---

#### 恢复备份
```
/dst backup restore <房间ID> <序号>
```
**功能**: 从备份恢复房间
**权限**: 管理员
**示例**:
```
/dst backup restore 2 1
```

**说明**: 会停止服务器，恢复备份，然后自动重启

---

### 模组管理

#### 搜索模组
```
/dst mod search <关键词>
```
**功能**: 从 Steam Workshop 搜索模组
**权限**: 所有用户
**示例**:
```
/dst mod search 健康血条
/dst mod DST
```

**输出示例**:
```
🔍 模组搜索结果：健康血条
找到 3 个模组，显示前 5 个：

1. Health Info
   - ID: workshop-1185229307
   - 大小: 15.2MB
   - 订阅数：1,234,567

2. Health Bar
   - ID: workshop-375850593
   - 大小: 8.7MB
   - 订阅数: 567,890

💡 使用 /dst mod add <房间ID> <世界ID> <模组ID> 添加模组
```

---

#### 查看已安装模组
```
/dst mod list <房间ID>
```
**功能**: 查看房间已安装的模组
**权限**: 所有用户
**示例**:
```
/dst mod list 2
```

**输出示例**:
```
🧩 已安装模组 (勋棱神话)
共 21 个模组

1. Workshop-1185229307
   - 状态：✅ 已启用

2. Workshop-1392778117
   - 状态：✅ 已启用

...（更多模组）
```

---

#### 添加模组
```
/dst mod add <房间ID> <世界ID> <模组ID>
```
**功能**: 向服务器添加模组
**权限**: 管理员
**示例**:
```
/dst mod add 2 1 1185229307
/dst mod add 2 1 workshop-1185229307
```

**说明**: 
- 世界ID：1=Master, 2=Caves
- 模组ID 可以带或不带 `workshop-` 前缀
- 会自动下载、配置、启用模组

---

#### 删除模组
```
/dst mod remove <房间ID> <世界ID> <模组ID>
```
**功能**: 从服务器移除模组
**权限**: 管理员
**示例**:
```
/dst mod remove 2 1 1185229307
```

**说明**: 会从房间配置中移除模组引用

---

#### 检测模组冲突
```
/dst mod check <房间ID>
```
**功能**: 检测已安装模组的潜在冲突
**权限**: 所有用户
**示例**:
```
/dst mod check 2
```

**输出示例**:
```
🔍 模组冲突检测 (勋棱神话)
已安装 21 个模组

✅ 未发现明显冲突
💡 这只是基础检测，具体冲突需要人工检查
```

---

### 控制台命令

#### 执行控制台命令
```
/dst console <房间ID> [世界ID] <命令>
```
**功能**：向游戏服务器发送 Lua 控制台命令
**权限**：管理员
**示例**：
```
/dst console 2 c_announce("服务器将在10分钟后重启")
/dst console 2 1 c_regenerateworld()
/dst console 2 c_save()
```

**说明**：
- 不指定世界 ID = 发送到所有世界
- 指定世界 ID = 发送到指定世界
- 命令需要用引号包裹字符串参数

**常用命令**：
- `c_announce("消息")` - 发送全服公告
- `c_regenerateworld()` - 重新生成世界
- `c_save()` - 保存游戏
- `c_shutdown()` - 关闭服务器
- `c_reset()` - 重置世界

---

#### 发送全服公告
```
/dst announce <房间ID> <消息>
```
**功能**：向游戏内所有玩家发送公告
**权限**：管理员
**示例**：
```
/dst announce 2 服务器将在10分钟后重启
```

**说明**：
- 消息会自动转义，无需手动处理引号
- 自动发送到所有世界

---

## 🔒 权限说明

### 普通用户
- 查看所有房间列表和详情
- 查看在线玩家
- 查看备份列表
- 搜索和查看模组
- 检测模组冲突

### 睇理员
- 所有普通用户权限
- 启动/关闭/重启房间
- 踢出玩家
- 创建备份
- 恢复备份
- 添加/删除/启用/禁用模组
- 执行控制台命令
- 发送全服公告

---

## 💡 使用技巧

### 快捷操作
1. **查看服务器状态**：`/dst info 2`
2. **查看在线玩家**：`/dst players 2`
3. **快速重启**：`/dst restart 2`
4. **发送公告**：`/dst announce 2 "公告内容"`

### 常见问题

**Q: 如何获取房间 ID？**
A: 使用 `/dst list` 查看所有房间，第一列是序号，使用对应的房间 ID

**Q: 如何获取世界 ID？**
A: 
- 1 = Master（地表）
- 2 = Caves（洞穴）

**Q: 模组 ID 从哪里获取？**
A: 使用 `/dst mod search <关键词>` 搜索，或从 Steam Workshop 网页获取

**Q: 如何获取 KU_ID？**
A: 使用 `/dst players <房间ID>` 查看，KU_ID 显示在玩家信息中

**Q: 命令没有响应？**
A: 
1. 检查命令格式是否正确
2. 确认是否有权限
3. 查看错误提示

---

## 📊 命令统计

- **总命令数**: 17 个
- **普通用户命令**: 10 个
- **管理员命令**: 7 个

---

## 🔗 相关链接

- GitHub: https://github.com/your-repo/nonebot-dst-management
- 文档: https://github.com/your-repo/nonebot-dst-management/docs
- 问题反馈: https://github.com/your-repo/nonebot-dst-management/issues

---

**最后更新**: 2026-02-03
**维护者**: 小安 (Xiao An)
**QQ群**: 744834037
